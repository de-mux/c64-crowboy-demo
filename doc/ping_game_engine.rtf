{\rtf1\mac\ansicpg10000\cocoartf102
{\fonttbl\f0\fnil\fcharset77 Baskerville;\f1\fnil\fcharset77 Baskerville-SemiBold;\f2\fnil\fcharset77 Baskerville-BoldItalic;
\f3\fnil\fcharset77 Baskerville-Italic;\f4\fmodern\fcharset77 Courier;\f5\fmodern\fcharset77 Courier-BoldOblique;
}
{\colortbl;\red255\green255\blue255;}
\margl1440\margr1440\vieww11140\viewh12660\viewkind0
\pard\tx1440\tx2880\tx4320\tx5760\tx7200\ql\qnatural

\f0\fs36 \cf0 Programming with the Ping Game Engine
\fs20 \
\
\
\

\f1\b\fs24 Understanding the main interrupt loop
\f0\b0\fs28 \

\fs24 The heart of the Ping Game Engine lies in IRQ interrupt routines. This allows for accurate timing necessary to keep the game running smoothly. There is a different interrupt routine for each mode of the program: Main Menu, World Update, and Screen Update.\
When the game begins, the IRQ vector is set to point to the World Update routine. This will update everything about the game world, such as enemies, sprites, the player, background scroll, and anything to prepare the Screen Update to draw. The World Update routine then sets the IRQ vector to the Screen Update, which updates the screen as needed before resetting the IRQ vector back to the World Update. These two routines alternate back and   forth until the game ends or is paused.\
Within the World Update routine are different modes of operation, depending on the state of the game. These handle fades, general game updates, etc, and are discussed in more detail in the "Game Modes" section.\
\

\f1\b Game Modes
\f0\b0 \
\
\

\f1\b Update Routines: 
\f2\i World Update
\f1\i0  and 
\f2\i Screen Update\

\f0\i0\b0 The World Update and Screen Update routines go hand in hand in ensuring the smoothest gameplay possible. The World Update routine must prepare Screen Update to set sprite positions, perform page-flipping and smooth scrolling, among other graphics-related tasks. Since Screen Update must update the entire screen in a small amount of time to avoid screen flicker, World Update must do most of the time-expensive tasks. Specific tasks are outlined below.\

\f2\i\b World Update
\f0\i0\b0 \
World Update must perform the following tasks to get Screen Update ready for drawing a frame of animation:\
	Read input (joystick, keyboard)\
	Update player/enemy sprites (positions, images, attributes)\
	Update screen smooth scrolling position and rough scrolling position\
	Update player/enemy sprite positions to reflect new scroll delta\
	Copy level data to offscreen page\
	Copy color data for current frame to an array\
After these tasks have been completed, World Update sets the next interrupt to point to Screen Update.\

\f2\i\b Screen Update
\f0\i0\b0 \
To run as quickly as possible, most of what Screen Update does is to simply copy data set up by World Update to screen memory, all computations having been made previously. This involves the following tasks:\
	Copy color data prepared by World Update to VIC color memory\
	Set VIC smooth X scroll register\
	Set screen memory to point to the offscreen page (page-flip)\
	Move all sprites to desired positions\
The Screen Update will then set the next interrupt to point back to World Update, and the entire Update process is repeated for another frame.\
\
\
\
\

\f1\b Data Structures\
\
Naming Conventions\

\f0\b0 To distinguish between different types of data, there are certain conventions for how their names are written.\
Variables:	variableName\
Constants:	
\f1\b k
\f0\b0 VariableName\
Subroutines:	SubroutineName\
Block of data:	(same as Subroutines)\
Zeropage Vars: (same as Subroutines)\
Record: 	name
\f1\b _record
\f0\b0 \
	
\f1\b \
Records\

\f0\b0 Records are like 
\f3\i structs
\f0\i0  in C. They are collections of data that provide a simple way of keeping related items grouped together. In Ping, the naming convention for a record with the name 'person' would be 
\f4\fs20 person_record
\f0\fs24 , and a member 'age' of 
\f4\fs20 person_record
\f0\fs24  might be 
\f4\fs20 p_age
\f0\fs24 , or 
\f4\fs20 per_age
\f0\fs24 (notice the first letter is lowercase). The reason you wouldn't write 
\f4\fs20 person_age
\f0\fs24  is to distinguish between the record itself and the members of that record. Here's an example of a record in an assembly file:\
\
	
\f4 person_record:\
	per_age	dc.b 0\
	per_sex	dc.b 0\
	per_job	dc.b 0
\f0 \
\
If you need an array of records, replace all instances of '
\f4\fs20 dc.b 0
\f0\fs24 ' with '
\f4\fs20 ds.b 
\f5\i\b\fs24 x
\f0\i0\b0 ', where 
\f5\i\b x
\f0\i0\b0  is the size of the array.\
\

\f1\b \
}